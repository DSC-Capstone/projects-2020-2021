# RNASeqToolComparison
Data Science Senior Capstone Project: Comparing RNA Sequencing Differential Gene Expression Analysis Tools

In this project, we want to compare distinct differential gene expression analysis tools on simulated data created with different numbers of genes differentially expressed.

## Running the project
* Use the command `launch.sh -i buijoseph21/rna-seq-tool-comparison:v1 -m 6 -P Always` in order to have the necessary software from `compcodeR` (e.g., `generateSyntheticData`, `runDiffExp`, `ABSSeq`, `PoissonSeq`, etc.) to generate the synthetic data & perform differential gene expression analysis. The `-m 6` specifies the number of RAM which is needed to run tools that require more memory. 

## Building the project using `run.py`
* Use the command `python run.py build` to generate the synthetic data in `data/data<N>.rds`, where N represents the dataset number, using `generateSyntheticData`
* Use the command `python run.py analysis` to perform `DESeq2`, `edgeR.exact`, `NOISeq`, `PoissonSeq`, `ttest`, `ABSSeq`, and `voom.limma` on the synthetic data created in `data` folder which returns the results in `out/data<N>_<tool>.rds`, where N represents the dataset number & tool represents the software. The output of each tool will be organized in its respective `<tool_name><synthetic_data_num>` folders in the `<tool_name>` folders. 
* Use the command `python run.py graph` to build area under the curves (AUC), type I error rates, accuracy, sensitivity, specificity, and False Discovery Rates (FDR) graphs to compare how well the tools performed with each other. The output of each of the graphs will be stored in `rna_graphs`.
* Use the command `python run.py real` to run the whole pipeline mentioned above on the real life dataset: Post-Mortem Molecular Profiling of Schizophrenia, Bipolar Disorder, and Major Depressive Disorder (https://genomemedicine.biomedcentral.com/articles/10.1186/s13073-017-0458-5). 

## Running the project on test data
* `ssh` into dsmlp and `git clone` the repository
* Use the command `launch.sh -i buijoseph21/rna-seq-tool-comparison:v1 -m 6` in order to have the necessary software from `compcodeR` (e.g., `generateSyntheticData`, `runDiffExp`, `PoissonSeq`, etc.) to generate the test synthetic data & perform differential gene expression analysis. The `-m 6` specifies the number of RAM which is needed to run tools that require more memory. 
* Use the command `python run.py test` to create a test synthetic dataset of 100 genes differentially expressed where 50 are differentially expressed in condition 1 and 50 are differentially expressed in condition 2. This test dataset contains 5 samples per condition and is a baseline model with no outliers containing abnormal counts. When running `python run.py test`, it should first create a synthetic dataset which will be stored in the `data` folder and named as `test.rds`. Next, the 7 tools will be performed on the `test.rds` where the outputs will be stored in the `out/test` folder which is created when ran. Each tool will produce different results which is stored in `test_<tool>.rds`. For the next step of our pipeline, we want to produce the area under the curve for this test data, which will be stored in `/out/test/test_auc_plot.png` & the summary of all the metrics in `statistics.csv`.

## Group Contributions
* Joseph built the dockerfile/container. He also created the starter code for building the synthetic datasets and performing differential expression analysis tools in `compcodeR` such as `DESeq2`, `edgeR`, `NOISeq`, `voom.limma`, and `ttest`. He was able to create an R script that read all the outputs from each tool mentioned previously to write out to a `num_expressed_by_tool.csv`. He created the notebook that illustrates the timings/duration for each of the tools performed on each synthetic dataset. As for the report, he helped write the Abstract, Background, Dataset (Figure 1), Methods (Creating the synthetic data, DESeq2, NOISeq, edgeR.exact), and briefly explained Figure 3. He also looked over other sections to add onto or revise. 
* Brandon was responsible for creating the `random` outlier synthetic datasets and performing differential expression analysis tools not built-in `compcodeR`, including `ABSSeq` and `PoissonSeq`. Brandon helped write out to the `num_expressed_by_tool.csv` for his outputs produced by `ABSSeq` and `PoissonSeq`. As for the report, he helped write the Dataset and analysis of Figure 3. He also looked over other sections to add onto or revise. Brandon mainly focused on creating the graphs for the comparisons. 
* Luigi was responsible for creating the `single` outlier and `poisson` synthetic datasets and helped perform `NOISeq` and `voom.limma` on the synthetic datasets. As for the report, Luigi created the citations, made revisions based on comments suggested by Shannon, and briefly described Figure 2. He wrote the Methods section for ABSSeq and PoissonSeq. Luigi was mainly responsible for the creation of the website and running/creating the pipeline for the real life dataset. 
